#include <filesystem>
#include <sstream>
#include <tape_pool.hpp>
#include <tape_view.hpp>

////////////////////////////////////////////////////////////////////////////////
TapeView::TapeView(TapePool& owner, Tape& tape) : owner_{&owner}, tape_{&tape} {
}

////////////////////////////////////////////////////////////////////////////////
std::int32_t TapeView::read() {
  owner_->increaseReadsCnt();
  return tape_->read();
}

////////////////////////////////////////////////////////////////////////////////
void TapeView::write(std::int32_t x) {
  owner_->increaseWritesCnt();
  tape_->write(x);
}

////////////////////////////////////////////////////////////////////////////////
void TapeView::moveLeft() {
  tape_->moveLeft();
  owner_->increaseMovesCnt();
}

////////////////////////////////////////////////////////////////////////////////
void TapeView::moveLeftRepeated(std::size_t n) {
  for (std::size_t i = 0; i < n; ++i) {
    moveLeft();
  }
}

////////////////////////////////////////////////////////////////////////////////
void TapeView::moveRight() {
  tape_->moveRight();
  owner_->increaseMovesCnt();
}

////////////////////////////////////////////////////////////////////////////////
void TapeView::moveRightRepeated(std::size_t n) {
  for (std::size_t i = 0; i < n; ++i) {
    moveRight();
  }
}
